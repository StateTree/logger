!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("logger",[],e):"object"==typeof exports?exports.logger=e():t.logger=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e,n){window,t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r=function(t,e){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==t&&null==e)return 0;if(null==t)return 1;if(null==e)return-1;n||(t=String(t).toLocaleLowerCase(),e=String(e).toLocaleLowerCase());var r=String(t).localeCompare(e);return r<-1?r=-1:r>1&&(r=1),r},o=function(t,e){return isNaN(t)&&isNaN(e)?0:isNaN(t)?1:isNaN(e)?-1:t<e?-1:t>e?1:0},i=function(t,e){if(t===e)return 0;if(null==t)return 1;if(null==e)return-1;var n,r=t.length,o=e.length;if(r<o)return-1;if(r>o)return 1;for(var i=0;i<r;i++)if(0!=(n=l(t[i],e[i])))return n;return 0},f=function(t,e){if(t===e)return 0;if(null==t)return 1;if(null==e)return-1;var n=Object.keys(t),r=Object.keys(e),o=n.length,i=r.length;if(o===i&&0===o)return 0;if(o>i)return 1;if(o<i)return-1;for(var f,u,a=0;a<o;a++)if(f=n[a],!e.hasOwnProperty(f))return-1;for(a=0;a<i;a++)if(f=r[a],0!==(u=l(t[f],e[f])))return u;return 0},u=function(t,e){return null!=t&&null!=e&&(t instanceof e||("string"==typeof t?e===String:"number"==typeof t?e===Number:"boolean"==typeof t&&e===Boolean))};function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var l=function(t,e){if(t===e)return 0;if(null==t)return 1;if(null==e)return-1;var n=a(t),l=a(e);return n!==l?r(n,l):"boolean"===n?o(Number(t),Number(e)):"number"===n?o(t,e):"string"===n?r(t,e):u(t,Date)?function(t,e){if(null===t&&null===e)return 0;if(null===t)return 1;if(null===e)return-1;var n=t.getTime(),r=e.getTime();return n<r?-1:n>r?1:0}(t,e):u(t,Array)?i(t,e):u(t,Object)?f(t,e):0};function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t){return"object"!==c(t)||null===t?t:Array.isArray(t)?function(t){return t.map(function(t){return s(t)})}(t):function(t){var e={};return Object.keys(t).forEach(function(n){var r=t[n];e[n]=s(r)},{}),e}(t)}function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function b(t,e){for(var n,r=Object.keys(t),o=Object.keys(e),i=r.length,f=o.length,u=0,a={},c=0;c<i;c++)if(n=r[c],e.hasOwnProperty(n)){a[n]=!0;var s=t[n],p=e[n];l(s,p)&&u++}else u++;for(var b=0;b<f;b++)a[n=o[b]]||u++;return u}function y(t,e){if("object"!==p(t)&&"object"!==p(e))throw new Error("Expecting Object got obj1 type: ".concat(p(t)," and  obj2 type: ").concat(p(e)));for(var n,r,o,i=Object.keys(t),f=Object.keys(e),u=i.length,a=f.length,c=0,b=0,y=0,v={},h={},d={},m=0;m<u;m++)n=i[m],e.hasOwnProperty(n)?(d[n]=!0,r=t[n],o=e[n],l(r,o)&&(h[n]="object"===p(r)?s(r):r,v[n]="object"===p(o)?s(o):o,c++)):(r=t[n],h[n]="object"===p(r)?s(r):r,y++);for(m=0;m<a;m++)d[n=f[m]]||(o=e[n],h[n]="delete",v[n]="object"===p(o)?s(o):o,b++);return{forward:v,backward:h,count:b+c+y}}function v(t,e){if("object"!==p(t)&&"object"!==p(e))throw new Error("Expecting Object got obj1 type: ".concat(p(t)," and  obj2 type: ").concat(p(e)));for(var n,r,o,i=Object.keys(t),f=Object.keys(e),u=i.length,a=f.length,c=!1,b={},y={},h={},d=0;d<u;d++)if(n=i[d],e.hasOwnProperty(n))if(h[n]=!0,r=t[n],o=e[n],"object"===p(r)&&"object"===p(o)){var m=v(s(r),s(o));if(m){var g=m.forward,j=m.backward;b[n]=g,y[n]=j,c=!0}}else l(r,o)&&(y[n]="object"===p(r)?s(r):r,b[n]="object"===p(o)?s(o):o,c=!0);else r=t[n],y[n]="object"===p(r)?s(r):r,b[n]="delete",c=!0;for(d=0;d<a;d++)h[n=f[d]]||(o=e[n],y[n]="delete",b[n]="object"===p(o)?s(o):o,c=!0);if(c)return{backward:y,forward:b}}function h(t,e){var n,r;return"object"===p(e)&&(n=Object.keys(e)),"object"===p(t)&&(r=Object.keys(t)),(n?n.length:0)>(r?r.length:0)?n:r}function d(t,e,n){if(n||(n=s),!e)return n(t);var r=t.forward,o=t.backward,i=e.forward,f=e.backward;r=n(r);var u=function t(e,n,r,o){var i=function(t,e,n,r){var o=h(t,r),i=h(n,e);if(i)for(var f=0;f<i.length;f++){var u=i[f];o.indexOf(u)<0&&o.push(u)}return o}(e,n,r,o),f=r||{},u=o||{},a=!1;if(i)for(var l=0;l<i.length;l++){var c=i[l],s="object"===p(n)?n[c]:n,b=u[c],y="object"===p(e)?e[c]:e,v=f[c];if("object"===p(y)||"object"===p(s)){var d=t(y,s,v,b);"object"===p(y)&&"object"!==p(s)?(f[c]=d.forward,u[c]=s,a=!0):"object"===p(s)&&"object"!==p(y)?(u[c]=d.backward,f[c]=y,a=!0):d?(a=!0,u[c]=d.backward,f[c]=d.forward):(delete f[c],delete u[c])}else y===s?(delete f[c],delete u[c]):(v!==y&&(f[c]=void 0===y?v:y),b!==s&&(u[c]=void 0===s?b:s),a=!0)}return a?{forward:f,backward:u}:void 0}(i=n(i),o=n(o),r,f=n(f));return u||void 0}function m(t,e,n){n||(n=s);var r=p(t),o=p(e);if(!t||!e||r!==o)return"object"===o?n(e):e;t&&(t=n(t)),e&&(e=n(e));for(var i,f,u,a=0,l=Object.keys(e),c=l.length;a<c;a++)f=t[i=l[a]],"delete"===(u=e[i])?delete t[i]:f&&"object"===p(f)&&"object"===p(u)?t[i]=m(f,u):u&&(t[i]=u);return t}function g(t,e){return 0===l(t,e)&&(e=void 0),e}n.d(e,"default",function(){return g}),n.d(e,"compare",function(){return l}),n.d(e,"getDiff",function(){return y}),n.d(e,"getObjectDiff",function(){return v}),n.d(e,"combineDiff",function(){return d}),n.d(e,"applyDiff",function(){return m}),n.d(e,"getDiffCount",function(){return b})}])},function(t,e,n){window,t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.next=null,this.prev=null};n.d(e,"default",function(){return o});var o=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pivot=null,this.head=null,this.tail=null,this.length=0,e&&this.create(e)};o.prototype.insert=function(t,e,n){var o,i,f=new r(t);this.length++,this.pivot?this.pivot.next?(o=this.pivot,i=this.pivot.next,e&&e(o,f,i),f.next=o.next,f.prev=o,o.next=f,i.prev=f,this.pivot=f,n&&n(o,f,i)):(o=this.pivot,e&&e(o,f),o.next=f,f.prev=o,this.pivot=f,this.tail=f,n&&n(o,f)):(e&&e(f),this.pivot=f,this.head=f,n&&n(f))},o.prototype.shiftPivot=function(t){var e,n=this.pivot;for(t>=0&&(e=!0);0!==t;)e?(n=n.next)===this.tail?t=0:t--:(n=n.prev)===this.head?t=0:t++;return this.pivot=n,this.pivot},o.prototype.shiftPivotToHead=function(){this.pivot=this.head},o.prototype.shiftPivotToTail=function(){this.pivot=this.tail},o.prototype.create=function(t){var e=this;t.map(function(t){e.insert(t)})},o.prototype.traverse=function(t,e){for(var n=e?this.tail:this.head;n;)t(n.element),n=e?n.prev:n.next},o.prototype.toArray=function(){var t=[];return this.traverse(function(e){t.push(e)}),t},o.prototype.getPivotElement=function(){return this.pivot?this.pivot.element:null},o.prototype.next=function(){var t=this.pivot.next?this.pivot.next:this.pivot;return this.pivot=t,t},o.prototype.prev=function(){var t=this.pivot.prev?this.pivot.prev:this.pivot;return this.pivot=t,t},o.prototype.isPivotHead=function(){return this.pivot===this.head},o.prototype.isPivotTail=function(){return this.pivot===this.tail},o.prototype.reset=function(){this.pivot=null,this.head=null,this.tail=null,this.length=0}}])},function(t,e,n){"use strict";n.r(e);var r=n(1),o=n.n(r);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t){var e=JSON.stringify(t);return JSON.parse(e)}function u(t,e){var n,r,o,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],f=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=null,a=f?[]:void 0;if(t)for(u={},n=0;n<t.length;n++)u[r="string"==typeof(o=t[n])?o:o[e]]=o,i&&(t[n]=r),f&&a.push(r);return f?{obj:u,keys:a}:u}function a(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=i(t),l=i(e);if(null!=t&&null!=e&&o===l&&r){for(var c=u(t,"id",!0),s=u(e,"id",!1,!0),p=s.obj,b=s.keys,y=0;y<b.length;y++){var v=b[y],h=c[v],d=p[v];if(h)if("string"!=typeof h){if("string"!=typeof d)if(d.classDefName!==h.classDefName)c[v]=f(d);else{var m=d.classDefName===n;h.value=a(h.value,d.value,n,m)}}else h!==d&&(c[v]=f(d));else c[v]=f(d),t.push(v)}for(var g=0;g<t.length;g++)t[g]=c[t[g]]}else t="object"===l?f(e):e;return t}function l(t){return"object"!==i(t)||null===t?t:Array.isArray(t)?function(t){return t.map(function(t){return l(t)})}(t):function(t){var e={};return Object.keys(t).forEach(function(n){var r=t[n];e[n]=l(r)},{}),e}(t)}var c=n(0);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e,n){if(n){var r=e.element.forward,o=e.element.backward,i=n.element.forward,f=n.element.backward,u=Object(c.combineDiff)(f,r),a=Object(c.combineDiff)(i,o);e.forward=u,e.backward=a}}function b(t,e,n){for(var r,o={};t>0;)"backward"===e?(r=n.pivot,n.shiftPivot(-1)):"forward"===e&&(r=n.shiftPivot(1)),o=Object(c.combineDiff)(o,r.element),t-=1;return o}function y(t,e,n){return"undo"===n?b(-e,"backward",t):b(e,"forward",t)}var v=function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.logList=new o.a([]),this.saveDiffCallback=null,this.enable=!0,e&&e.getState&&e.applyDiff?(this.context=e,n=e.getState()):n=e,this.lastActiveState=r?n:l(n)};function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t,e,n){if(n){var r=e.element.forward,o=e.element.backward,i=n.element.forward,f=a(n.element.backward.value,r.value,this.objectVerifier,!0),u=a(i.value,o.value,this.objectVerifier,!0);e.forward=f,e.backward=u}}function m(t,e,n,r){for(var o,i;t>0;){"backward"===e?(o=n.pivot,n.shiftPivot(-1)):"forward"===e&&(o=n.shiftPivot(1));var f=o.element[e];i=a(i,f.value,r,f.classDefName===r),t-=1}return i}function g(t,e,n,r){var o,i=this.context,f=this.logList;r&&(this.objectVerifier=r),o="undo"===e?m(-t,"backward",f,r):m(t,"forward",f,r);var u=this;i.applyDiff.call(i,o,function(){j.call(u),n()})}function j(){this.lastActiveState=this.context.getState()}v.prototype.setSaveCallback=function(t){this.saveDiffCallback=t},v.prototype.removeSaveCallback=function(){this.saveDiffCallback=null},v.prototype.undo=function(t){isNaN(t)&&(t=1);var e,n=y(this.logList,-t,"undo").backward;return e=this.context&&this.context.applyDiff?this.context.applyDiff(n):Object(c.applyDiff)(this.lastActiveState,n),this.lastActiveState=e,l(e)},v.prototype.redo=function(t){isNaN(t)&&(t=1);var e,n=y(this.logList,t,"redo").forward;return e=this.context&&this.context.applyDiff?this.context.applyDiff(n):Object(c.applyDiff)(this.lastActiveState,n),this.lastActiveState=e,l(e)},v.prototype.save=function(t){if(this.enable){var e=Object(c.getObjectDiff)(this.lastActiveState,t),n=e.forward,r=e.backward;"object"===s(n)&&"object"===s(r)&&(this.logList.insert(e,p),this.lastActiveState=l(t)),this.saveDiffCallback&&this.saveDiffCallback(e)}},v.prototype.getCurrentLog=function(){return this.logList?this.logList.getPivotElement():null},v.prototype.clear=function(){this.logList.reset()};var w=function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e||console.error("Context cant be null"),e.applyDiff||console.error("Context needs to implement applyDiff method"),e.getState||console.error("Context needs to implement getState method"),e.getDiff||console.error("Context needs to implement getDiff method"),this.context=e,this.logList=new o.a([]),this.saveDiffCallback=null,this.enable=!0,this.objectVerifier=n,j.call(this),this.objectVerifier,d=d.bind(this)};w.prototype.setSaveCallback=function(t){this.saveDiffCallback=t},w.prototype.removeSaveCallback=function(){this.saveDiffCallback=null},w.prototype.undo=function(t,e,n){isNaN(t)&&(t=1),g.call(this,-t,"undo",e,n)},w.prototype.redo=function(t,e,n){isNaN(t)&&(t=1),g.call(this,t,"redo",e,n)},w.prototype.save=function(){if(this.enable){var t;if(this.context){var e=t=this.context.getDiff(this.lastActiveState,!0),n=e.forward,r=e.backward;"object"===h(n)&&"object"===h(r)&&(this.logList.insert(t,d),j.call(this))}this.saveDiffCallback&&this.saveDiffCallback(t)}},w.prototype.getCurrentLog=function(){return this.logList?this.logList.getPivotElement():null},w.prototype.clear=function(){this.logList.reset()},n.d(e,"default",function(){return v}),n.d(e,"DiffLogger",function(){return w})}])});