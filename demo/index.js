!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("logger",[],e):"object"==typeof exports?exports.logger=e():t.logger=e()}(window,function(){return function(t){var e={};function o(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=3)}([function(t,e,o){window,t.exports=function(t){var e={};function o(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){"use strict";o.r(e);var n=function(t,e){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==t&&null==e)return 0;if(null==t)return 1;if(null==e)return-1;o||(t=String(t).toLocaleLowerCase(),e=String(e).toLocaleLowerCase());var n=String(t).localeCompare(e);return n<-1?n=-1:n>1&&(n=1),n},r=function(t,e){return isNaN(t)&&isNaN(e)?0:isNaN(t)?1:isNaN(e)?-1:t<e?-1:t>e?1:0},i=function(t,e){if(t===e)return 0;if(null==t)return 1;if(null==e)return-1;var o,n=t.length,r=e.length;if(n<r)return-1;if(n>r)return 1;for(var i=0;i<n;i++)if(0!=(o=u(t[i],e[i])))return o;return 0},f=function(t,e){if(t===e)return 0;if(null==t)return 1;if(null==e)return-1;var o=Object.keys(t),n=Object.keys(e),r=o.length,i=n.length;if(r===i&&0===r)return 0;if(r>i)return 1;if(r<i)return-1;for(var f,a,l=0;l<r;l++)if(f=o[l],!e.hasOwnProperty(f))return-1;for(l=0;l<i;l++)if(f=n[l],0!==(a=u(t[f],e[f])))return a;return 0},a=function(t,e){return null!=t&&null!=e&&(t instanceof e||("string"==typeof t?e===String:"number"==typeof t?e===Number:"boolean"==typeof t&&e===Boolean))};function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var u=function(t,e){if(t===e)return 0;if(null==t)return 1;if(null==e)return-1;var o=l(t),u=l(e);return o!==u?n(o,u):"boolean"===o?r(Number(t),Number(e)):"number"===o?r(t,e):"string"===o?n(t,e):a(t,Date)?function(t,e){if(null===t&&null===e)return 0;if(null===t)return 1;if(null===e)return-1;var o=t.getTime(),n=e.getTime();return o<n?-1:o>n?1:0}(t,e):a(t,Array)?i(t,e):a(t,Object)?f(t,e):0};function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t){return"object"!==c(t)||null===t?t:Array.isArray(t)?function(t){return t.map(function(t){return s(t)})}(t):function(t){var e={};return Object.keys(t).forEach(function(o){var n=t[o];e[o]=s(n)},{}),e}(t)}function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e){for(var o,n=Object.keys(t),r=Object.keys(e),i=n.length,f=r.length,a=0,l={},c=0;c<i;c++)if(o=n[c],e.hasOwnProperty(o)){l[o]=!0;var s=t[o],p=e[o];u(s,p)&&a++}else a++;for(var v=0;v<f;v++)l[o=r[v]]||a++;return a}function b(t,e){if("object"!==p(t)&&"object"!==p(e))throw new Error("Expecting Object got obj1 type: ".concat(p(t)," and  obj2 type: ").concat(p(e)));for(var o,n,r,i=Object.keys(t),f=Object.keys(e),a=i.length,l=f.length,c=0,v=0,b=0,y={},d={},h={},g=0;g<a;g++)o=i[g],e.hasOwnProperty(o)?(h[o]=!0,n=t[o],r=e[o],u(n,r)&&(d[o]="object"===p(n)?s(n):n,y[o]="object"===p(r)?s(r):r,c++)):(n=t[o],d[o]="object"===p(n)?s(n):n,b++);for(g=0;g<l;g++)h[o=f[g]]||(r=e[o],d[o]="delete",y[o]="object"===p(r)?s(r):r,v++);return{forward:y,backward:d,count:v+c+b}}function y(t,e){if("object"!==p(t)&&"object"!==p(e))throw new Error("Expecting Object got obj1 type: ".concat(p(t)," and  obj2 type: ").concat(p(e)));for(var o,n,r,i=Object.keys(t),f=Object.keys(e),a=i.length,l=f.length,c=!1,v={},b={},d={},h=0;h<a;h++)if(o=i[h],e.hasOwnProperty(o))if(d[o]=!0,n=t[o],r=e[o],"object"===p(n)&&"object"===p(r)){var g=y(s(n),s(r));if(g){var m=g.forward,j=g.backward;v[o]=m,b[o]=j,c=!0}}else u(n,r)&&(b[o]="object"===p(n)?s(n):n,v[o]="object"===p(r)?s(r):r,c=!0);else n=t[o],b[o]="object"===p(n)?s(n):n,v[o]="delete",c=!0;for(h=0;h<l;h++)d[o=f[h]]||(r=e[o],b[o]="delete",v[o]="object"===p(r)?s(r):r,c=!0);if(c)return{backward:b,forward:v}}function d(t,e){var o,n;return"object"===p(e)&&(o=Object.keys(e)),"object"===p(t)&&(n=Object.keys(t)),(o?o.length:0)>(n?n.length:0)?o:n}function h(t,e,o){if(o||(o=s),!e)return o(t);var n=t.forward,r=t.backward,i=e.forward,f=e.backward;n=o(n);var a=function t(e,o,n,r){var i=function(t,e,o,n){var r=d(t,n),i=d(o,e);if(i)for(var f=0;f<i.length;f++){var a=i[f];r.indexOf(a)<0&&r.push(a)}return r}(e,o,n,r),f=n||{},a=r||{},l=!1;if(i)for(var u=0;u<i.length;u++){var c=i[u],s="object"===p(o)?o[c]:o,v=a[c],b="object"===p(e)?e[c]:e,y=f[c];if("object"===p(b)||"object"===p(s)){var h=t(b,s,y,v);"object"===p(b)&&"object"!==p(s)?(f[c]=h.forward,a[c]=s,l=!0):"object"===p(s)&&"object"!==p(b)?(a[c]=h.backward,f[c]=b,l=!0):h?(l=!0,a[c]=h.backward,f[c]=h.forward):(delete f[c],delete a[c])}else b===s?(delete f[c],delete a[c]):(y!==b&&(f[c]=void 0===b?y:b),v!==s&&(a[c]=void 0===s?v:s),l=!0)}return l?{forward:f,backward:a}:void 0}(i=o(i),r=o(r),n,f=o(f));return a||void 0}function g(t,e,o){o||(o=s);var n=p(t),r=p(e);if(!t||!e||n!==r)return"object"===r?o(e):e;t&&(t=o(t)),e&&(e=o(e));for(var i,f,a,l=0,u=Object.keys(e),c=u.length;l<c;l++)f=t[i=u[l]],"delete"===(a=e[i])?delete t[i]:f&&"object"===p(f)&&"object"===p(a)?t[i]=g(f,a):a&&(t[i]=a);return t}function m(t,e){return 0===u(t,e)&&(e=void 0),e}o.d(e,"default",function(){return m}),o.d(e,"compare",function(){return u}),o.d(e,"getDiff",function(){return b}),o.d(e,"getObjectDiff",function(){return y}),o.d(e,"combineDiff",function(){return h}),o.d(e,"applyDiff",function(){return g}),o.d(e,"getDiffCount",function(){return v})}])},function(t,e,o){window,t.exports=function(t){var e={};function o(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0)}([function(t,e,o){"use strict";o.r(e);var n=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.element=e,this.next=null,this.prev=null};o.d(e,"default",function(){return r});var r=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pivot=null,this.head=null,this.tail=null,this.length=0,e&&this.create(e)};r.prototype.insert=function(t,e,o){var r,i,f=new n(t);this.length++,this.pivot?this.pivot.next?(r=this.pivot,i=this.pivot.next,e&&e(r,f,i),f.next=r.next,f.prev=r,r.next=f,i.prev=f,this.pivot=f,o&&o(r,f,i)):(r=this.pivot,e&&e(r,f),r.next=f,f.prev=r,this.pivot=f,this.tail=f,o&&o(r,f)):(e&&e(f),this.pivot=f,this.head=f,o&&o(f))},r.prototype.shiftPivot=function(t){var e,o=this.pivot;for(t>=0&&(e=!0);0!==t;)e?(o=o.next)===this.tail?t=0:t--:(o=o.prev)===this.head?t=0:t++;return this.pivot=o,this.pivot},r.prototype.shiftPivotToHead=function(){this.pivot=this.head},r.prototype.shiftPivotToTail=function(){this.pivot=this.tail},r.prototype.create=function(t){var e=this;t.map(function(t){e.insert(t)})},r.prototype.traverse=function(t,e){for(var o=e?this.tail:this.head;o;)t(o.element),o=e?o.prev:o.next},r.prototype.toArray=function(){var t=[];return this.traverse(function(e){t.push(e)}),t},r.prototype.getPivotElement=function(){return this.pivot?this.pivot.element:null},r.prototype.next=function(){var t=this.pivot.next?this.pivot.next:this.pivot;return this.pivot=t,t},r.prototype.prev=function(){var t=this.pivot.prev?this.pivot.prev:this.pivot;return this.pivot=t,t},r.prototype.isPivotHead=function(){return this.pivot===this.head},r.prototype.isPivotTail=function(){return this.pivot===this.tail},r.prototype.reset=function(){this.pivot=null,this.head=null,this.tail=null,this.length=0}}])},function(t,e,o){"use strict";o.r(e);var n=o(1),r=o.n(n);function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function f(t){var e=JSON.stringify(t);return JSON.parse(e)}function a(t,e){var o,n,r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],f=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=null,l=f?[]:void 0;if(t)for(a={},o=0;o<t.length;o++)a[n="string"==typeof(r=t[o])?r:r[e]]=r,i&&(t[o]=n),f&&l.push(n);return f?{obj:a,keys:l}:a}function l(t,e,o){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=i(t),u=i(e);if(null!=t&&null!=e&&r===u&&n){for(var c=a(t,"id",!0),s=a(e,"id",!1,!0),p=s.obj,v=s.keys,b=0;b<v.length;b++){var y=v[b],d=c[y],h=p[y];if(d)if("string"!=typeof d){if("string"!=typeof h)if(h.classDefName!==d.classDefName)c[y]=f(h);else{var g=h.classDefName===o;d.value=l(d.value,h.value,o,g)}}else d!==h&&(c[y]=f(h));else c[y]=f(h),t.push(y)}for(var m=0;m<t.length;m++)t[m]=c[t[m]]}else t="object"===u?f(e):e;return t}function u(t){return"object"!==i(t)||null===t?t:Array.isArray(t)?function(t){return t.map(function(t){return u(t)})}(t):function(t){var e={};return Object.keys(t).forEach(function(o){var n=t[o];e[o]=u(n)},{}),e}(t)}var c=o(0);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e,o){if(o){var n=e.element.forward,r=e.element.backward,i=o.element.forward,f=o.element.backward,a=Object(c.combineDiff)(f,n),l=Object(c.combineDiff)(i,r);e.forward=a,e.backward=l}}function v(t,e,o){for(var n,r={};t>0;)"backward"===e?(n=o.pivot,o.shiftPivot(-1)):"forward"===e&&(n=o.shiftPivot(1)),r=Object(c.combineDiff)(r,n.element),t-=1;return r}function b(t,e,o){return"undo"===o?v(-e,"backward",t):v(e,"forward",t)}var y=function t(e){var o,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.logList=new r.a([]),this.saveDiffCallback=null,this.enable=!0,e&&e.getState&&e.applyDiff?(this.context=e,o=e.getState()):o=e,this.lastActiveState=n?o:u(o)};function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e,o){if(o){var n=e.element.forward,r=e.element.backward,i=o.element.forward,f=l(o.element.backward.value,n.value,this.objectVerifier,!0),a=l(i.value,r.value,this.objectVerifier,!0);e.forward=f,e.backward=a}}function g(t,e,o,n){for(var r,i;t>0;){"backward"===e?(r=o.pivot,o.shiftPivot(-1)):"forward"===e&&(r=o.shiftPivot(1));var f=r.element[e];i=l(i,f.value,n,f.classDefName===n),t-=1}return i}function m(t,e,o,n){var r,i=this.context,f=this.logList;n&&(this.objectVerifier=n),r="undo"===e?g(-t,"backward",f,n):g(t,"forward",f,n);var a=this;i.applyDiff.call(i,r,function(){j.call(a),o()})}function j(){this.lastActiveState=this.context.getState()}y.prototype.setSaveCallback=function(t){this.saveDiffCallback=t},y.prototype.removeSaveCallback=function(){this.saveDiffCallback=null},y.prototype.undo=function(t){isNaN(t)&&(t=1);var e,o=b(this.logList,-t,"undo").backward;return e=this.context?Object(c.applyDiff)(o):Object(c.applyDiff)(this.lastActiveState,o),this.lastActiveState=e,u(e)},y.prototype.redo=function(t){isNaN(t)&&(t=1);var e,o=b(this.logList,t,"redo").forward;return e=this.context?Object(c.applyDiff)(o):Object(c.applyDiff)(this.lastActiveState,o),this.lastActiveState=e,u(e)},y.prototype.save=function(t){if(this.enable){var e=Object(c.getObjectDiff)(this.lastActiveState,t),o=e.forward,n=e.backward;"object"===s(o)&&"object"===s(n)&&(this.logList.insert(e,p),this.lastActiveState=u(t)),this.saveDiffCallback&&this.saveDiffCallback(e)}},y.prototype.getCurrentLog=function(){return this.logList?this.logList.getPivotElement():null},y.prototype.clear=function(){this.logList.reset()};var S=function t(e,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e||console.error("Context cant be null"),e.applyDiff||console.error("Context needs to implement applyDiff method"),e.getState||console.error("Context needs to implement getState method"),e.getDiff||console.error("Context needs to implement getDiff method"),this.context=e,this.logList=new r.a([]),this.saveDiffCallback=null,this.enable=!0,this.objectVerifier=o,j.call(this),this.objectVerifier,h=h.bind(this)};S.prototype.setSaveCallback=function(t){this.saveDiffCallback=t},S.prototype.removeSaveCallback=function(){this.saveDiffCallback=null},S.prototype.undo=function(t,e,o){isNaN(t)&&(t=1),m.call(this,-t,"undo",e,o)},S.prototype.redo=function(t,e,o){isNaN(t)&&(t=1),m.call(this,t,"redo",e,o)},S.prototype.save=function(){if(this.enable){var t;if(this.context){var e=t=this.context.getDiff(this.lastActiveState,!0),o=e.forward,n=e.backward;"object"===d(o)&&"object"===d(n)&&(this.logList.insert(t,h),j.call(this))}this.saveDiffCallback&&this.saveDiffCallback(t)}},S.prototype.getCurrentLog=function(){return this.logList?this.logList.getPivotElement():null},S.prototype.clear=function(){this.logList.reset()},o.d(e,"default",function(){return y}),o.d(e,"DiffLogger",function(){return S})},function(t,e,o){"use strict";o.r(e);o(0);var n=o(2);function r(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var i={value:{one:1,two:2},getState:function(){return function(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{},n=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(o).filter(function(t){return Object.getOwnPropertyDescriptor(o,t).enumerable}))),n.forEach(function(e){r(t,e,o[e])})}return t}({},this.value)},setState:function(t,e){this.value[t]=e},applyDiff:function(t){this.value=t}},f=i.getState();console.log("StateO: ",f);var a,l=new n.default(f);l.setSaveCallback(function(t){console.log("Diff Log: ",t)}),i.setState("three",3),f=i.getState(),console.log("State1: ",f),l.save(i.getState()),i.setState("four",4),f=i.getState(),console.log("State2: ",f),l.save(i.getState()),i.setState("five",5),f=i.getState(),console.log("State3: ",f),l.save(i.getState()),a=l.undo(),i.applyDiff(a),console.log("After 1 Undo: ",i.value),a=l.undo(),i.applyDiff(a),console.log("After 2 Undo: ",i.value),a=l.redo(),i.applyDiff(a),console.log("After 1 redo: ",i.value),a=l.redo(),i.applyDiff(a),console.log("After 2 redo: ",i.value),a=l.undo(2),i.applyDiff(a),console.log("After Undo 2 Steps: ",i.value),a=l.redo(2),i.applyDiff(a),console.log("After Redo 2 Steps: ",i.value),i.setState("six",6),l.save(i.getState()),a=l.undo(),i.applyDiff(a),console.log("After Undo: ",i.value),a=l.redo(),i.applyDiff(a),console.log("After redo: ",i.value),i.setState("six",66),l.save(i.getState()),a=l.undo(),i.applyDiff(a),console.log("After Undo: ",i.value),a=l.redo(),i.applyDiff(a),console.log("After redo: ",i.value),i.setState("six",{num:6}),l.save(i.getState()),a=l.undo(),i.applyDiff(a),console.log("After Undo: ",i.value),a=l.redo(),i.applyDiff(a),console.log("After redo: ",i.value),i.setState("six",{num:66}),i.setState("five",{num:55}),l.save(i.getState()),a=l.undo(),i.applyDiff(a),console.log("After Undo: ",i.value),a=l.redo(),i.applyDiff(a),console.log("After redo: ",i.value)}])});